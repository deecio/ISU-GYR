<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Bootstrap Library Link -->
    <link href="https://s3.amazonaws.com/codecademy-content/projects/bootstrap.min.css" rel="stylesheet" />
    <link href="SCStyle.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,900" rel="stylesheet">
    <link href="../css/baseV4.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.css" media="all" rel="stylesheet">
    <link href="http://yandex.st/highlightjs/8.0/styles/tomorrow.min.css" media="all" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Bungee|Roboto" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>Live Green! Shopping Cart</title>
</head>
<body class="responsive wd-p-Responsive wd-show-sidebar wd-p-ShowSidebar" ng-app="gyrApp" ng-controller="ShoppingCartViewerDB">
    <div class="wd-l-Header hwrapper" id="header">
        <div class="wd-l-Header-inner">
            <div class="wd-l-TopStrip isu-dark-ribbon" id="top-strip">
                <div class="wd-l-TopStrip-inner">
                    <ul class="wd-ResponsiveToggles">
                        <li><button class="wd-ResponsiveToggles-nav">menu</button></li>
                        <li><button class="wd-ResponsiveToggles-search">search</button></li>
                    </ul>
                    <div class="wd-l-TopStripMenu">
                        <ul class="wd-l-TopStripMenu-group wd-l-TopStripMenu-group--signons first">
                            <li>
                                <a class="wd-l-TopStripMenu-header" href="javascript:;">Sign-ons <i class="fa fa-angle-down"></i></a>
                                <ul class="wd-l-TopStripMenu-toolbar">
                                    <li class="first"><a href="http://cymail.iastate.edu/">CyMail</a></li>
                                    <li><a href="http://outlook.iastate.edu/">Outlook</a></li>
                                    <li><a href="http://bb.its.iastate.edu/">Blackboard</a></li>
                                    <li class="last"><a href="http://accessplus.iastate.edu/">AccessPlus</a></li>
                                </ul>
                            </li>
                        </ul>

                        <ul class="wd-l-TopStripMenu-group wd-l-TopStripMenu-group--directory last">
                            <li>
                                <a class="wd-l-TopStripMenu-header" href="javascript:;">More <i class="fa fa-angle-down"></i></a>
                                <ul class="wd-l-TopStripMenu-toolbar">
                                    <li class="first"><a href="http://info.iastate.edu/">Directory</a></li>
                                    <li><a href="http://www.fpm.iastate.edu/maps/">Maps</a></li>
                                    <li class="last"><a href="http://www.iastate.edu/contact/">Contact Us</a></li>
                                </ul>
                            </li>
                        </ul>

                        <ul class="wd-l-TopStripMenu-group wd-l-TopStripMenu-group--index">
                            <li>
                                <a class="wd-l-TopStripMenu-header" href="http://www.iastate.edu/index/A">Index</a>
                                <ul class="wd-l-TopStripMenu-toolbar">
                                    <li class="first"><a href="http://www.iastate.edu/index/A/">A</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/B/">B</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/C/">C</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/D/">D</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/E/">E</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/F/">F</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/G/">G</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/H/">H</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/I/">I</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/J/">J</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/K/">K</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/L/">L</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/M/">M</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/N/">N</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/O/">O</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/P/">P</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/Q/">Q</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/R/">R</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/S/">S</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/T/">T</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/U/">U</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/V/">V</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/W/">W</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/X/">X</a></li>
                                    <li class=""><a href="http://www.iastate.edu/index/Y/">Y</a></li>
                                    <li class="last"><a href="http://www.iastate.edu/index/Z/">Z</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="wd-l-Ribbon isu-red-ribbon" id="ribbon" role="banner">
                <div class="wd-l-Ribbon-inner">
                    <form action="//google.iastate.edu/search" class="wd-l-SearchBox isu-search-form" method="GET" role="search">
                        <input name="output" type="hidden" value="xml_no_dtd" />
                        <input name="client" type="hidden" value="default_frontend" />
                        <input name="proxystylesheet" type="hidden" value="default_frontend" />
                        <input accesskey="s" name="q" title="Search" placeholder="Search" tabindex="1" type="text" />
                        <input name="btnG" title="Submit" type="submit" value="Search" />
                    </form>
                    <a accesskey="1" class="wd-Nameplate nameplate" href="http://www.iastate.edu/">
                        <img alt="Iowa State University" src="../img/sprite.png" />
                    </a>

                    <div class="wd-l-MastTitle-siteTitle site-title sub-title">
                        <a href="/">Office of Sustainability</a>
                    </div>
                </div>
            </div>
            <div class="wd-l-Navbar">
                <div class="wd-l-Navbar-inner">
                    <div role="navigation">
                        <ul class="wd-Navigation">
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link" href="../index.html">Home</a>
                            </li>
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link" href="../gyr/apartment.html">Interactive Room</a>
                            </li>
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link is-active" href="#">Sustainability Savings Cart</a>
                            </li>
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link" href="../FactPage.html">Green Living Tips</a>
                            </li>
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link" href="../QuizPage.html">Green Living Quiz</a>
                            </li>
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link" href="../results.php">Green Living Quiz Results</a>
                            </li>
                            <li class="wd-Navigation-node">
                                <a class="wd-Navigation-link" href="../information.html">Additional Resources</a>
                            </li>
                            <li class="wd-Navigation-node right hide-on-med-and-down" align="right">
                                <a class="wd-Navigation-link" href="../admin/index.html">Admin</a>
                            </li>
                        </ul>
                    </div>
                    <select class="wd-Navigation-alt navigation-alternative" onchange="window.location=this.value" title="Navigation">
                        <option value="index.html">Home</option>
                        <option value="savingscart.html" selected="selected">Savings Cart</option>
                        <option value="information.html">Information</option>
                        <option value="results.php">Quiz Results</option>
                        <option value="FactPage.html">Trivia</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <!--Screen 1: User selects category for currently-owned item to be replaced-->
            <div class="col-xs-8 shop-screen StartShopScreen">
                <h2 class="screen-title">
                    Select an item category:
                </h2>
                <div class="col-xs-4 filter" ng-repeat="filter in filters">
                    <div class="card filter-card" ng-click="setFilter(filter);" onclick="switchShopScreens('.InitItemScreen'); showSidebar();">
                        <div class="">
                            <img class="filter-image" src="{{filter.image}}" />
                        </div>
                        <a href="" class="btn btn-default waves-effect waves-light">{{filter.name}}</a>
                    </div>
                </div>
            </div>

            <!--Screen 1.5: Persistant category selector-->
            <div class="col-xs-2 categories collection">
                <div class="row sidebar-row" ng-repeat="filter in filters">
                    <a href="" class="collection-item" ng-class="{active:$first}" ng-click="setFilter(filter);" onclick="switchShopScreens('.InitItemScreen');"><i class="tiny material-icons">label</i>{{filter.name}}</a>
                </div>
            </div>

            <!--Screen 2: Populate the screen with a scolling list of all the items of the selected category from Screen 1-->
            <div class="col-xs-6 shop-screen InitItemScreen card">
                <h2 class="screen-title">
                    Select the item you CURRENTLY own:
                </h2>
                <div class="items">
                    <div class="col-lg-4 centered item-slot" ng-repeat="item in data.db_result | filter: selectedFilter.filterExpr">
                        <a class="item-button" ng-click="setFirstCost(item.monthly_cost, item);">
                            <div class="card z-depth-0">
                                <img class="card-image" ng-src="{{item.image}}" />
                                <h3 class="item-name">{{item.name}}</h3>
                                <h4 class="price">{{item.monthly_cost | currency}} per month</h4>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!--Screen 3: User selects new item-->
            <div class="col-xs-6 shop-screen SecondItemCategory card">
                <h2 class="screen-title">
                    Select the REPLACEMENT item you want to buy:
                </h2>

                <div class="items">
                    <div class="col-lg-4 centered item-slot" ng-repeat="item in items | filter: selectedFilter.filterExpr">
                        <a class="item-button" ng-click="setSecondCost(item.monthly_cost, item);" onclick="resetActive();">
                            <div class="card z-depth-0">
                                <img class="card-image" ng-src="{{item.image}}" />
                                <h3 class="item-name">{{item.name}}</h3>
                                <h4 class="price">{{item.monthly_cost | currency}} per month</h4>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!--Screen 4: Calculate and display total-->
            <div class="col-xs-4 receipt-screen Calculator">
                <div class="card sc-tutorial">
                    <p>Looking to substitute some of your household items for something more sustainable? Learn about the impact your products make and how your choices can make a difference!</p>
                    <p>Instructions:</p>
                    <ol>
                        <li>Select an item category.</li>
                        <li>Select the item currently in your room (or the item you'd like to learn more about).</li>
                        <li>Select an environmentally-friendly replacement (or the item you'd like to learn more about).</li>
                        <li>Check out the Saving Receipt to find out how much you'll save.</li>
                    </ol>
                </div>
                <h2 class="screen-title centered">
                    Current Savings
                </h2>
                <div class="card-panel" id="receipt">
                    <h3 class="centered">Savings Receipt:</h3>
                    <div class="row history" ng-repeat="entry in firstItem">
                        {{entry.name}} -> {{secondItem[$index].name}} = ${{diffSet[$index]}}
                    </div>

                    <div class="row">
                        <h3>{{diff | currency}}</h3>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-xs-12 centered">
                <a class="btn btn-default reset" onClick="window.location.reload()">Reset</a>
            </div>
        </div>
    </div>

    <div class="wd-l-Footer">
        <div class="wd-l-Footer-inner">

            <div class="GLimage">
                <img src="../img/footer.png" />
            </div>

            <div class="wd-l-PageFooter" id="footer" role="contentinfo">
                <div class="wd-l-PageFooter-inner">
                    <div class="wd-Grid wd-Grid--fitToFill wd-Grid--noGutter">

                        <div class="wd-Grid-cell wd-Grid-cell--1">
                            <div class="wd-l-PageFooter-nameplate">
                                <a class="wd-Nameplate" href="http://www.iastate.edu/">
                                    <img alt="Iowa State University" src="../img/sprite.png">
                                </a>
                            </div>
                        </div>

                        <div class="wd-Grid-cell wd-Grid-cell--2">
                            <div class="wd-l-PageFooter-content">
                                <div class="region region-footer">
                                    <div id="block-block-1" class="block block-block">


                                        <div class="content">
                                            <p>Copyright � 1995-2016, Iowa State University of Science and Technology. All rights reserved.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-resource.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-route.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.4/angular-material.min.js"></script>
    <script src="app.js"></script>
    <!-- <script src="ListController.js"></script> -->
    <script type="text/javascript" charset="utf-8" src="js/fabric.min.js"></script>
    <script>
    		function httpService($http) {
    				this.get = function(url) {
    						return $http.get(url);
    				}
    				this.post = function(url, data) {
    						return $http.post(url, data);
    				}
    		}
    		angular.module('gyrApp', []).service('httpService', httpService)
    				.controller('ShoppingCartViewerDB', function($scope, httpService) {

              //Daniel's code to do the calculations
              $scope.title = 'Item List Test';
              $scope.diff = 0;
              $scope.initCost = 0;
              $scope.newCost = 0;

              $scope.firstItem = [];
              $scope.secondItem = [];
              $scope.diffSet = [];

              $scope.filters = [
                  { name: 'All', filterExpr: '', image: '../img/world.png' },
                  { name: 'Lighting', filterExpr: { category: 'lighting' }, image: '../img/Lighting/fluorbulb.jpg' },
                  { name: 'Blenders', filterExpr: { category: 'Blenders' }, image: '../img/Blenders/blender.jpg' },
                  { name: 'Gaming Consoles', filterExpr: { category: 'Gaming Consoles' }, image: '../img/Gaming Consoles/fluorbulb.jpg' },
                  { name: 'Televisions', filterExpr: { category: 'Televisions' }, image: '../img/Televisions/miniFridge.jpg' },
                  { name: 'Printers', filterExpr: { category: 'Printers' }, image: '../img/Printers/blender.jpg' },
                  { name: 'Computers', filterExpr: { category: 'Computers' }, image: '../img/Computers/fluorbulb.jpg' },
                  { name: 'Coffee Maker', filterExpr: { category: 'Coffee Maker' }, image: '../img/Coffee Maker/miniFridge.jpg' },
                  { name: 'Microwave', filterExpr: { category: 'Microwave' }, image: '../img/Microwaves/microwave.jpg' },
                  { name: 'Refrigerator', filterExpr: { category: 'Refrigerator' }, image: '../img/Refrigerators/miniFridge.jpg' }

                  // Commenting this part out for now, bring back when screen 3 filters are changed to match the item, not the filter from screen 1.
                  //{ name: 'Energy Star Approved', filterExpr: { eStar: true } }
              ];

              $scope.currentFilter = $scope.filters[0];

              $scope.setFilter = function (filter) {
                  $scope.selectedFilter = filter;
              }

              $scope.switchShopScreens = function (screenClass) {
                  $(".shop-screen").hide();

                  $(screenClass).fadeIn();
              };

              $scope.setFirstCost = function (value, item) {
                  $scope.initCost = value;
                  $scope.FI = item;
                  switchShopScreens(".SecondItemCategory");
              }

              $scope.setSecondCost = function (value, item) {
                  $scope.firstItem.push($scope.FI);
                  $scope.secondItem.push(item);
                  $scope.newCost = value;
                  $scope.diff += $scope.initCost - $scope.newCost;
                  $scope.diffSet.push($scope.initCost - $scope.newCost);
                  $scope.setFilter('');
                  switchShopScreens(".InitItemScreen");
              }

              //Database call
    						$scope.data = {};
    						httpService.get("http://greenyourresidence.ece.iastate.edu:3000/ShoppingCartViewerDB")
    						// This is where the response is received v
    								.then(function(rtn) {
    										$scope.data = rtn.data;
    								});
    					 });

    </script>
</body>
</html>
